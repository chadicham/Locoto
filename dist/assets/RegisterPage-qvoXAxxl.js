import{j as e,Y as s,T as a,r,as as t,at as n,au as o,am as i,J as l,H as m,av as d,aw as c,an as u,ao as p,I as h,ap as x,aq as j,w as f,ar as g}from"./mui-vendor-Cj1s4jkd.js";import{u as v,a as b,L as N}from"./react-vendor-YkhZaqhD.js";import{b as w}from"./redux-vendor-MKZRiqK7.js";import{a as y}from"./axiosConfig-kM0HH6AN.js";import{s as C}from"./index-B7rz5ZSC.js";import"./date-vendor-Bw6RkLa7.js";const P=["Informations personnelles","Authentification"],A=()=>{const A=w(),S=v(),[I,k]=b.useState(0),[W,q]=b.useState({firstName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}),[D,L]=b.useState(!1),[z,F]=b.useState(""),[H,T]=b.useState(!1),V=e=>{q({...W,[e.target.name]:e.target.value}),F("")},$=()=>{if(0===I){if(!W.firstName||!W.lastName||!W.phoneNumber)return F("Veuillez remplir tous les champs obligatoires"),!1;if(!W.phoneNumber.match(/^(\+33|0)[1-9](\d{8})$/))return F("Numéro de téléphone invalide"),!1}else{if(!W.email||!W.password||!W.confirmPassword)return F("Veuillez remplir tous les champs obligatoires"),!1;if(!W.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))return F("Adresse email invalide"),!1;if(W.password.length<8)return F("Le mot de passe doit contenir au moins 8 caractères"),!1;if(W.password!==W.confirmPassword)return F("Les mots de passe ne correspondent pas"),!1}return!0},E=async e=>{var s,a;if(e.preventDefault(),$()){T(!0);try{const e={firstName:W.firstName,lastName:W.lastName,email:W.email,password:W.password,phoneNumber:W.phoneNumber},s=await y.post("/auth/register",e);s.data.token&&(localStorage.setItem("token",s.data.token),A(C({user:s.data.data.user,token:s.data.token})),S("/"))}catch(r){F((null==(a=null==(s=r.response)?void 0:s.data)?void 0:a.message)||"Une erreur est survenue lors de l'inscription")}finally{T(!1)}}};return e.jsxs(s,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",p:2,bgcolor:"background.default"},children:[e.jsx(s,{sx:{mb:4,textAlign:"center"},children:e.jsx(a,{variant:"h4",component:"h1",sx:{fontWeight:600},children:"Créer un compte"})}),e.jsxs(r,{elevation:2,sx:{p:3,maxWidth:400,mx:"auto",width:"100%"},children:[e.jsx(t,{activeStep:I,sx:{mb:4},children:P.map(s=>e.jsx(n,{children:e.jsx(o,{children:s})},s))}),e.jsxs("form",{onSubmit:E,children:[z&&e.jsx(i,{severity:"error",sx:{mb:2},children:z}),0===I?e.jsxs(e.Fragment,{children:[e.jsx(l,{fullWidth:!0,label:"Prénom",name:"firstName",value:W.firstName,onChange:V,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(m,{position:"start",children:e.jsx(d,{color:"action"})})}}),e.jsx(l,{fullWidth:!0,label:"Nom",name:"lastName",value:W.lastName,onChange:V,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(m,{position:"start",children:e.jsx(d,{color:"action"})})}}),e.jsx(l,{fullWidth:!0,label:"Téléphone",name:"phoneNumber",value:W.phoneNumber,onChange:V,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(m,{position:"start",children:e.jsx(c,{color:"action"})})}})]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{fullWidth:!0,label:"Email",name:"email",type:"email",value:W.email,onChange:V,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(m,{position:"start",children:e.jsx(u,{color:"action"})})}}),e.jsx(l,{fullWidth:!0,label:"Mot de passe",name:"password",type:D?"text":"password",value:W.password,onChange:V,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(m,{position:"start",children:e.jsx(p,{color:"action"})}),endAdornment:e.jsx(m,{position:"end",children:e.jsx(h,{edge:"end",onClick:()=>L(!D),children:D?e.jsx(x,{}):e.jsx(j,{})})})}}),e.jsx(l,{fullWidth:!0,label:"Confirmer le mot de passe",name:"confirmPassword",type:D?"text":"password",value:W.confirmPassword,onChange:V,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(m,{position:"start",children:e.jsx(p,{color:"action"})})}})]}),e.jsxs(s,{sx:{mt:3,display:"flex",justifyContent:"space-between"},children:[I>0&&e.jsx(f,{onClick:()=>{k(e=>e-1),F("")},children:"Retour"}),e.jsx(f,{variant:"contained",onClick:I===P.length-1?E:()=>{$()&&(k(e=>e+1),F(""))},sx:{ml:"auto"},disabled:H,children:I===P.length-1?H?"Inscription...":"S'inscrire":"Suivant"})]}),e.jsx(s,{sx:{mt:3,textAlign:"center"},children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Déjà inscrit ?"," ",e.jsx(g,{component:N,to:"/login",variant:"body2",children:"Se connecter"})]})})]})]})]})};export{A as default};
