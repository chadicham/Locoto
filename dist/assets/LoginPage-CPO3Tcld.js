import{j as e,Y as s,T as a,r as t,am as r,J as o,H as n,an as i,ao as l,I as d,ap as c,aq as m,ar as x,w as u,ai as p}from"./mui-vendor-Cj1s4jkd.js";import{u as h,f as j,a as f}from"./react-vendor-YkhZaqhD.js";import{b as g}from"./redux-vendor-MKZRiqK7.js";import{a as v}from"./axiosConfig-kM0HH6AN.js";import{s as b}from"./index-B7rz5ZSC.js";import"./date-vendor-Bw6RkLa7.js";const y=()=>{var y,w;const S=g(),k=h(),A=(null==(w=null==(y=j().state)?void 0:y.from)?void 0:w.pathname)||"/",[C,q]=f.useState({email:"",password:""}),[I,W]=f.useState(!1),[z,L]=f.useState(""),[P,D]=f.useState(!1),H=e=>{q({...C,[e.target.name]:e.target.value}),L("")};return e.jsxs(s,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",p:2,bgcolor:"background.default"},children:[e.jsxs(s,{sx:{mb:4,textAlign:"center"},children:[e.jsx(a,{variant:"h4",component:"h1",sx:{fontWeight:600},children:"Locoto"}),e.jsx(a,{color:"text.secondary",children:"Connectez-vous à votre compte"})]}),e.jsx(t,{elevation:2,sx:{p:3,maxWidth:400,mx:"auto",width:"100%"},children:e.jsxs("form",{onSubmit:async e=>{var s,a;e.preventDefault();const t=(()=>{const e={};return C.email?/\S+@\S+\.\S+/.test(C.email)||(e.email="Format d'email invalide"):e.email="L'email est requis",C.password?C.password.length<6&&(e.password="Le mot de passe doit contenir au moins 6 caractères"):e.password="Le mot de passe est requis",e})();if(Object.keys(t).length>0)L("Veuillez corriger les erreurs dans le formulaire");else{D(!0),L("");try{const e=await v.post("/auth/login",C);e.data.token&&(localStorage.setItem("token",e.data.token),S(b({user:e.data.data.user,token:e.data.token})),k(A,{replace:!0}))}catch(r){L((null==(a=null==(s=r.response)?void 0:s.data)?void 0:a.message)||"Identifiants incorrects")}finally{D(!1)}}},children:[z&&e.jsx(r,{severity:"error",sx:{mb:2},children:z}),e.jsx(o,{fullWidth:!0,label:"Email",name:"email",type:"email",value:C.email,onChange:H,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(n,{position:"start",children:e.jsx(i,{color:"action"})})}}),e.jsx(o,{fullWidth:!0,label:"Mot de passe",name:"password",type:I?"text":"password",value:C.password,onChange:H,margin:"normal",required:!0,InputProps:{startAdornment:e.jsx(n,{position:"start",children:e.jsx(l,{color:"action"})}),endAdornment:e.jsx(n,{position:"end",children:e.jsx(d,{edge:"end",onClick:()=>W(!I),children:I?e.jsx(c,{}):e.jsx(m,{})})})}}),e.jsx(s,{sx:{mt:1,mb:2,textAlign:"right"},children:e.jsx(x,{href:"/forgot-password",variant:"body2",children:"Mot de passe oublié ?"})}),e.jsx(u,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:P,sx:{mb:2},children:P?e.jsx(p,{size:24,color:"inherit"}):"Se connecter"}),e.jsx(s,{sx:{textAlign:"center"},children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Pas encore de compte ?"," ",e.jsx(x,{href:"/register",variant:"body2",children:"S'inscrire"})]})})]})})]})};export{y as default};
