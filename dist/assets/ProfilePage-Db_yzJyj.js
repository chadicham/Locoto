import{j as e,Y as a,T as s,r,$ as i,w as t,aY as l,J as n,ai as o,a$ as m,b0 as d,am as u}from"./mui-vendor-Cj1s4jkd.js";import{a as c}from"./react-vendor-YkhZaqhD.js";import{b as h,u as x}from"./redux-vendor-MKZRiqK7.js";import{a as f}from"./axiosConfig-kM0HH6AN.js";import{u as j}from"./index-B7rz5ZSC.js";import"./date-vendor-Bw6RkLa7.js";const p=()=>{var p,b;const v=h(),N=x(e=>e.auth.user),[g,y]=c.useState(!1),[C,S]=c.useState(!1),[W,w]=c.useState(""),[E,q]=c.useState({firstName:"",lastName:"",email:"",phoneNumber:""}),[D,I]=c.useState("");c.useEffect(()=>{N&&q({firstName:N.firstName||"",lastName:N.lastName||"",email:N.email||"",phoneNumber:N.phoneNumber||""})},[N]);const P=e=>{q({...E,[e.target.name]:e.target.value})},z=()=>{w("")},H=()=>{I("")};return e.jsxs(a,{sx:{p:2,pb:8},children:[e.jsx(s,{variant:"h5",sx:{mb:3,fontWeight:600},children:"Mon Profil"}),e.jsxs(r,{sx:{p:3,mb:3},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsxs(i,{sx:{width:80,height:80,bgcolor:"primary.main",fontSize:"2rem",mr:2},children:[null==(p=E.firstName)?void 0:p[0],null==(b=E.lastName)?void 0:b[0]]}),e.jsxs(a,{children:[e.jsxs(s,{variant:"h6",children:[E.firstName," ",E.lastName]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:E.email})]})]}),!g&&e.jsx(t,{onClick:()=>y(!0),variant:"outlined",startIcon:e.jsx(l,{}),sx:{mt:3},fullWidth:!0,type:"button",children:"Modifier le profil"}),g&&e.jsx("form",{onSubmit:async e=>{var a,s;e.preventDefault(),S(!0),w("");try{const e=await(async e=>(await f.patch("/users/profile",e)).data)(E);v(j(e.data.user)),I("Profil mis à jour avec succès"),y(!1)}catch(r){w((null==(s=null==(a=r.response)?void 0:a.data)?void 0:s.message)||"Une erreur est survenue lors de la mise à jour du profil")}finally{S(!1)}},children:e.jsxs(a,{sx:{display:"grid",gap:2},children:[e.jsx(n,{label:"Prénom",name:"firstName",value:E.firstName,onChange:P,disabled:C,fullWidth:!0,required:!0}),e.jsx(n,{label:"Nom",name:"lastName",value:E.lastName,onChange:P,disabled:C,fullWidth:!0,required:!0}),e.jsx(n,{label:"Email",name:"email",type:"email",value:E.email,onChange:P,disabled:C,fullWidth:!0,required:!0}),e.jsx(n,{label:"Téléphone",name:"phoneNumber",value:E.phoneNumber,onChange:P,disabled:C,fullWidth:!0}),e.jsx(t,{type:"submit",variant:"contained",startIcon:C?e.jsx(o,{size:20}):e.jsx(m,{}),sx:{mt:3},fullWidth:!0,disabled:C,children:C?"Enregistrement...":"Enregistrer les modifications"})]})})]}),e.jsx(d,{open:!!W,autoHideDuration:6e3,onClose:z,children:e.jsx(u,{severity:"error",onClose:z,children:W})}),e.jsx(d,{open:!!D,autoHideDuration:6e3,onClose:H,children:e.jsx(u,{severity:"success",onClose:H,children:D})})]})};export{p as default};
